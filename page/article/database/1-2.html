<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- title -->
    <title>王贤兑的技术博客</title>

    <!-- meta -->
    <meta charset="UTF-8">

    <!-- links -->
    <link rel="stylesheet" type="text/css" media="screen" href="../../../css/style.css">

    <!-- scripts -->

    <!-- IE Hacks -->
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body class="home blog">

<!-- header -->
<header>
    <div id="light">
        <div class="container_16">
            <h1 class="grid_8" style="font-size: 45px"><a href="../../../index.html">Code Craft Of XD.Wang</a></h1>
            <nav class="grid_8">
                <ul id="menu-menu" class="menu">
                    <li><a href="../../../index.html">主页</a></li>
                    <li><a href="../../../page/list/blog.html">博客</a></li>
                    <li><a href="../../../page/list/me.html">ME</a></li>
                </ul>
            </nav>
        </div>
    </div>
</header>
<div class="copyrights">作者：王贤兑</div>

<!-- wrapper -->
<div id="wrapper">
    <div class="container_16">
        <section id="posts" class="prefix_1 grid_9">

            <article>
                <h2>Binary Log 简介</h2>
                <p class="info">February 13th, 2017 | by <span><a href="#" rel="author">XD.Wang</a></span> | database
                </p>
                <div class="time"><p>Feb<br><span>13</span></p></div>

                <p></p>

                <div class="text">
                    <p><img src="../../../images/article/database/1-1.png" height="200" width="500"></p>
                    <h4>概述：</h4>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MySql的日志系统能产生几种重要的日志文件：错误日志、通用日志、慢查询日志、Innodb
                        的Redo Log日志和二进制日志。错误日志记录了服务器在整个运行周期中出现的问题，通用日志记录了连接时执行的语句，慢查询日志
                        记录着执行时间超过阈值、以及查询无索引的语句。本篇博文将对二进制日志（Binary Log）做以概述。</p>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;概括而言，Binary Log用于记录做数据更新的SQL语句，具体内容包括：
                    <ul>
                        <li>更新后的数据；</li>
                        <li>DML语句的执行时间；</li>
                    </ul>

                    <h4>细节：</h4>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Binary Log记录了备份后进行的所有更新，因此可保证数据能恢复到故障出现前的状态，
                        此外，在数据库做读写分离后，从服务器可通过Binary Log读取到主服务器的更新，同步自己的数据。</p>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Binary Log用事件来组织日志内容。事件描述了库中的数据变动，比如增、删、改操作，当行级别
                        的日志记录未被启用时，事件中还会记录可能潜在导致数据变动的操作（如没有匹配到任意一行的删除操作）。</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Binary Log只记录引起数据变动的SQL，因此Select、Show等SQL并不会被记录到日志之中，如
                        需查看所有的SQL，需在通用日志（The General Query Log）中查看。</p>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;启用Binary Log对服务器性能稍有影响，但相对于它带来的好处：支持主从复制及数据恢复，轻微
                        的性能损失完全可以接受。</p>
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如果系统需要很高的保密性，就需要对Binary Log做安全控制，因为Binary Log中很可能记录
                        有业务上的敏感数据。</p>

                    <h4>应用：</h4>
                    <p>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>1. 启用</b><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a、修改my.cnf参数文件，该方法需要重新启动MySql<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log-bin = mysql-bin 打开日志，这个mysql-bin也可以自定义，这里也可以加上路径，
                        如：/home/xd/mysql_bin_log/mysql-bin
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关闭Binary Log：去掉log-bin = mysql-bin<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b、mysql版本在5.6以上时，可不重启修改配置：<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET @@global.log_bin=1|0 （1为开启，0为关闭）<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET @@global.binlog_size=37268（bytes）<br>
                    </p>
                    <p>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>2. 暂停</b><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET sql_log_bin={0|1}
                    </p>

                    <p>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>3. 修改Binary Log的大小</b><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;修改my.cnf参数文件中的max_binlog_size的值；<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如果你的二进制文件的大小超过了max_binlog_size，它就是自动创建新的二进制文件。
                        当然如果恰好在日志文件到达它的 最大尺寸时写入了大的事务，那么日志文件还是会超过max_binlog_size的大小
                    </p>

                    <p>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>4. 修改缓存大小</b><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binlog-cache-size=100m 设置Binary Log缓存大小；<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync-binlog=N 每隔N秒将缓存中的二进制日志记录写回硬盘，默认值为0
                    </p>


                </div>
                <div class="clear"></div>
            </article>

        </section>

        <aside class="prefix_1 grid_5">

            <!-- Categories-->
            <h4>Categories</h4>
            <ul class="categories">
                <li><a href="../../../page/list/lang.html">语言</a></li>
                <li><a href="../../../page/list/algorithm.html">算法</a></li>
                <li><a href="../../../page/list/framework.html">框架</a></li>
                <li><a href="../../../page/list/database.html">数据库</a></li>
                <li><a href="../../../page/list/arch.html">架构</a></li>
                <li><a href="../../../page/list/jvm.html">虚拟机</a></li>
                <li><a href="../../../page/list/bigdata.html">大数据</a></li>
                <li><a href="../../../page/list/tool.html">工具</a></li>
            </ul>
            <div class="clear"></div>
            <hr>

            <!-- article -->
            <h4>Articles</h4>
            <ul class="blogroll">
                <li><a href="../../../page/article/database/1-1.html">MySql性能优化</a></li>
                <li><a href="../../../page/article/database/1-2.html">Binary Log简介</a></li>
                <li><a href="../../../page/article/arch/1-1.html">分布式服务框架概述</a></li>
                <li><a href="../../../page/article/arch/1-2.html">通信框架设计：技术选型和可靠性</a></li>
                <li><a href="../../../page/article/bigdata/1-1.html">Spark快速入门</a></li>
                <li><a href="../../../page/article/jvm/1-1.html">JVM基础知识概述</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
            </ul>
            <hr>

        </aside>
    </div>
</div>

<!-- footer -->
<footer>
    <section id="footer_content">
        <div class="container_12">

        </div>
    </section>
    <section id="powered">
        <div class="container_12">
            <p class="grid_10"> code craft by <a href="https://lucifiere.github.io/"
                                                 title="王贤兑的博客" target="_blank"> XD.Wang </a></p>
            <p class="grid_2"><a class="top" href="#">▲ Back to top</a></p>
        </div>
    </section>
</footer>
</body>
</html>