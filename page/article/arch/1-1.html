<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- title -->
    <title>王贤兑的技术博客</title>

    <!-- meta -->
    <meta charset="UTF-8">

    <!-- links -->
    <link rel="stylesheet" type="text/css" media="screen" href="../../../css/style.css">

    <!-- scripts -->

    <!-- IE Hacks -->
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body class="home blog">

<!-- header -->
<header>
    <div id="light">
        <div class="container_16">
            <h1 class="grid_8" style="font-size: 45px"><a href="../../../index.html">Code Craft Of XD.Wang</a></h1>
            <nav class="grid_8">
                <ul id="menu-menu" class="menu">
                    <li><a href="../../../index.html">主页</a></li>
                    <li><a href="../../../page/list/blog.html">博客</a></li>
                    <li><a href="../../../page/list/me.html">ME</a></li>
                </ul>
            </nav>
        </div>
    </div>
</header>
<div class="copyrights">作者：王贤兑</div>

<!-- wrapper -->
<div id="wrapper">
    <div class="container_16">
        <section id="posts" class="prefix_1 grid_9">

            <article>
                <h2>分布式服务框架概述</h2>
                <p class="info">February 21th, 2017 | by <span><a href="#" rel="author">XD.Wang</a></span> | arch
                </p>
                <div class="time"><p>Feb<br><span>21</span></p></div>

                <p></p>

                <div class="text">
                    <p><img src="../../../images/article/arch/1-1.jpg" height="250" width="510"></p>

                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;随着越来越多的企业应用向SOA模式过度，支撑其实现的分布式服务框架也愈加重要，
                        无论是阿里的Dubbo、还是Apache的Thrift，在互联网行业都得到广泛的应用。此篇博客简单概括了分布式服务框架分析设计的几个要点，
                        使初学者对其有一个宏观的认识。</p>
                    <h4>分布式服务框架的架构</h4>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;简而言之，一个分布式服务框架可划分为三层</p>
                    <ul>
                        <li><b>RPC层：</b>RPC层包括底层通信框架、序列化框架，以及屏蔽前两者细节的Facade封装；</li>
                        <li><b>Filter Chain层：</b>服务调用职责链。可实现负载均衡、性能数据统计、失败重发等；</li>
                        <li><b>Service层：</b>通过动态代理将接口封装为远程调用，通过反射机制，根据接口名、方法名、参数列表等信息实现本地类处理业务，返回结果。</li>
                    </ul>
                    <h4>分布式服务框架的功能</h4>
                    <ul>
                        <li>
                            订阅发布：
                            <ul>
                                <li><b>根据配置文件发布和引用服务：</b>一般以XML的方式做服务发布或导入，避免对业务代码的侵入</li>
                                <li><b>服务自动发现：</b>服务消费者不需要自己配置服务提供者的地址，地址由注册中心推送</li>
                                <li><b>运行态注册/下线服务：</b>支持在运行时注册或下线一个服务</li>
                            </ul>
                        </li>
                        <li>
                            服务路由：
                            <ul>
                                <li><b>提供常见的路由策略：</b>比如随机路由、轮询路由、权重路由</li>
                                <li><b>粘滞连接：</b>总是向一个服务方发起请求，除非它挂掉</li>
                                <li><b>自定义路由：</b>允许用户指定自己的路由策略</li>
                            </ul>
                        </li>
                        <li>
                            容错策略：
                            <ul>
                                <li><b>Fail Over：</b>失效转移。当服务提供者故障，且操作为读操作或幂等写时，立即切换到其他服务提供者</li>
                                <li><b>Fail Back：</b>失败重试。当请求失败时，记录日志并重试，可用于消息推送</li>
                                <li><b>Fail Fast：</b>快速失败。只发起一次调用，失败立即报错，可用于非幂等写</li>
                            </ul>
                        </li>
                        <li>
                            服务调用：
                            <ul>
                                <li><b>同步调用：</b>消费者等待结果</li>
                                <li><b>异步调用：</b>提供者通知结果</li>
                                <li><b>并行调用：</b>对多个提供者同时发起请求，集中等待应答</li>
                            </ul>
                        </li>
                        <li>
                            协议支持：
                            <ul>
                                <li><b>私有协议：</b>支持私有协议定制和扩展</li>
                                <li><b>共有协议：</b>支持WebService等主流协议</li>
                            </ul>
                        </li>
                        <li>
                            协议支持：
                            <ul>
                                <li><b>二进制：</b>支持Thrift、Protocol buffer等二进制协议，提升序列化性能</li>
                                <li><b>文本：</b>支持JSON、XML等序列化方式，提升可读性和通用性</li>
                            </ul>
                        </li>
                        <li>
                            统一配置：
                            <ul>
                                <li><b>静态配置：</b>启动部署时候读取一次</li>
                                <li><b>动态配置：</b>修改后统一下发、实时生效</li>
                            </ul>
                        </li>
                        <li>
                            HA提升：
                            <ul>
                                <li><b>注册中心宕机检测：</b>通过心跳服务检测服务提供者的状态</li>
                                <li><b>注册中心宕机处理：</b>所有注册中心机器宕机后使用本地缓存</li>
                                <li><b>无状态服务：</b>服务提供者无状态，任意一台机器都可以平等替换</li>
                                <li>等......</li>
                            </ul>
                        </li>
                    </ul>
                    <h5>分布式服务框架的关注点</h5>
                    <ul>
                        <li>
                            运行管理：
                            <ul>
                                <li><b>服务路由：</b>通过修改路由策略实现导流</li>
                                <li><b>服务限流：</b>通过修改路由策略实现控流</li>
                                <li><b>服务迁移：</b>实现资源的动态分配、迁入迁出</li>
                                <li><b>服务降级：</b>关闭部分不必要服务，释放资源给关键服务</li>
                                <li><b>超时控制：</b>运行动态修改超时时间</li>
                            </ul>
                        </li>
                        <li>
                            服务监控：
                            <ul>
                                <li><b>性能统计：</b>统计出调用频度、时延、成功率等性能指标</li>
                                <li><b>历史统计：</b>统计历史的性能数据，生成分析报表</li>
                                <li><b>报警监控：</b>超过监控阈值给予报警</li>
                                <li><b>日志统计：</b>海量日志查询、检索、分析、定位</li>
                            </ul>
                        </li>
                        <li>
                            服务管理：
                            <ul>
                                <li><b>上线审批：</b>服务发布者不能随便发布服务</li>
                                <li><b>下线告知：</b>下线的服务将通告到所有使用者</li>
                                <li><b>灰度发布：</b>渐进性发布服务</li>
                            </ul>
                        </li>
                        <li>
                            服务安全：
                            <ul>
                                <li><b>服务等级：</b>只有符合特定权限的人才可以调用相应的服务</li>
                                <li><b>链路安全：</b>对消费者和发布者之间的长连接做安全防护</li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <div class="clear"></div>
            </article>

        </section>

        <aside class="prefix_1 grid_5">

            <!-- Categories-->
            <h4>Categories</h4>
            <ul class="categories">
                <li><a href="../../../page/list/lang.html">语言</a></li>
                <li><a href="../../../page/list/algorithm.html">算法</a></li>
                <li><a href="../../../page/list/framework.html">框架</a></li>
                <li><a href="../../../page/list/database.html">数据库</a></li>
                <li><a href="../../../page/list/arch.html">架构</a></li>
                <li><a href="../../../page/list/jvm.html">虚拟机</a></li>
                <li><a href="../../../page/list/bigdata.html">大数据</a></li>
                <li><a href="../../../page/list/tool.html">工具</a></li>
            </ul>
            <div class="clear"></div>
            <hr>

            <!-- article -->
            <h4>Articles</h4>
            <ul class="blogroll">
                <li><a href="../../../page/article/database/1-1.html">MySql性能优化</a></li>
                <li><a href="../../../page/article/database/1-2.html">Binary Log简介</a></li>
                <li><a href="../../../page/article/arch/1-1.html">分布式服务框架概述</a></li>
                <li><a href="../../../page/article/arch/1-2.html">通信框架设计：技术选型和可靠性</a></li>
                <li><a href="../../../page/article/bigdata/1-1.html">Spark快速入门</a></li>
                <li><a href="../../../page/article/jvm/1-1.html">JVM基础知识概述</a></li>
                <li><a href="../../../page/article/lang/1-2.html">理解Java线程池</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
            </ul>
            <hr>

        </aside>
    </div>
</div>

<!-- footer -->
<footer>
    <section id="footer_content">
        <div class="container_12">

        </div>
    </section>
    <section id="powered">
        <div class="container_12">
            <p class="grid_10"> code craft by <a href="https://lucifiere.github.io/"
                                                 title="王贤兑的博客" target="_blank"> XD.Wang </a></p>
            <p class="grid_2"><a class="top" href="#">▲ Back to top</a></p>
        </div>
    </section>
</footer>
</body>
</html>