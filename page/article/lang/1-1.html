<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- title -->
    <title>王贤兑的技术博客</title>

    <!-- meta -->
    <meta charset="UTF-8">

    <!-- links -->
    <link rel="stylesheet" type="text/css" media="screen" href="../../../css/style.css">

    <!-- scripts -->

    <!-- IE Hacks -->
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body class="home blog">

<!-- header -->
<header>
    <div id="light">
        <div class="container_16">
            <h1 class="grid_8" style="font-size: 45px"><a href="../../../index.html">Code Craft Of XD.Wang</a></h1>
            <nav class="grid_8">
                <ul id="menu-menu" class="menu">
                    <li><a href="../../../index.html">主页</a></li>
                    <li><a href="../../../page/list/blog.html">博客</a></li>
                    <li><a href="../../../page/list/me.html">ME</a></li>
                </ul>
            </nav>
        </div>
    </div>
</header>
<div class="copyrights">作者：王贤兑</div>

<!-- wrapper -->
<div id="wrapper">
    <div class="container_16">
        <section id="posts" class="prefix_1 grid_9">

            <article>
                <h2>ReentrantLock使用指南</h2>
                <p class="info">March 29th, 2017 | by <span><a href="#" rel="author">XD.Wang</a></span> | lang
                </p>
                <div class="time"><p>Mar<br><span>29</span></p></div>

                <p></p>

                <div class="text">
                    <p><img src="../../../images/article/lang/1-1.jpg" height="250" width="510"></p>

                    <h4>基本用法</h4>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReentrantLock是Java并发编程中常用的同步工具，它通过显式的加锁过程，灵活的控制着临界区的同步访问。
                        ReentrantLock之所以叫可重入锁，是因为它允许一个线程多次获取同一把锁。在JDK 1.6版本前Reentrant Lock的性能远胜于Synchronized关键字，
                        随着JDK 1.6中对Synchronized策略的优化，从性能角度来说两种方案基本持平，但对比功能性和灵活性，ReentrantLock更胜一筹。
                    </p>
                    <ul>
                        <li><b>reentrantLock.lock()：</b>获取锁。若锁计数为0，且第一次请求锁则获取锁，且锁计数器加一；若锁计数不为0，
                            非第一次请求锁则保持锁，且锁计数器加一；若锁计数不为0，且第一次请求锁则当前线程进入休眠状态，直到锁可获取。
                        </li>
                        <li><b>reentrantLock.unlock()：</b>释放锁。若锁计数为0，则抛出IllegalMonitorState Exception异常，否则锁计数器减一</li>
                    </ul>
                    <h4>高级特性</h4>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一般而言，线程尝试获取锁时会有两种情况，获取、阻塞，但Reentrant Lock允许线程响应中断，
                        从而取消获取锁。如需响应中断，获取锁时需要调用lockInterruptibly方法而非lock方法。
                    </p>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;响应中断可以处理死锁问题，除了响应中断外，限时等待也是处理死锁的一个利器。ReentrantLock允许线程进行有期限的锁等待，
                        用户可以定义在锁获取失败时的逻辑动作，使代码更加健壮。
                    </p>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如果使用Synchronized来加锁，锁的获取是无法保证公平的，
                        调度系统将随机指定某个线程获取锁，极端情况下，某些线程会一直获取不到锁，产生饥饿。ReentrantLock允许通过构造方法来产生一个公平锁，按先到先得的顺序来进行锁的分配。
                        由于ReentrantLock要维护一个队列来支持公平性，性能肯定就会有所降低，因此若非必要，不应乱用公平锁。
                    </p>
                    <p> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Synchronized可以通过wait和notify控制线程的等待和唤醒，条件锁也有类似的机制，
                        它通过Condition对象来改变线程的状态，让线程交出锁的使用权并等待，直到别的线程唤醒它，或者唤醒其他等待的线程。
                    </p>
                    <ul>
                        <li><b>reentrantLock.lockInterruptibly()：</b>获取可中断锁。</li>
                        <li><b>reentrantLock.tryLock(long time，TimeUnit timeUnit)：</b>在指定时间内获取锁，获取成功返回true。</li>
                        <li><b>ReentrantLock(boolean isFair)：</b>是否启用公平锁。</li>
                        <li><b>reentrantLock.newCondition()：</b>为该锁创建一个Condition。</li>
                        <li><b>condition.await()：</b>使当前线程等待。</li>
                        <li><b>condition.signal()：</b>唤醒一个线程。</li>
                        <li><b>condition.signalAll()：</b>唤醒所有等待线程。</li>
                    </ul>

                </div>
                <div class="clear"></div>
            </article>

        </section>

        <aside class="prefix_1 grid_5">

            <!-- Categories-->
            <h4>Categories</h4>
            <ul class="categories">
                <li><a href="../../../page/list/lang.html">语言</a></li>
                <li><a href="../../../page/list/algorithm.html">算法</a></li>
                <li><a href="../../../page/list/framework.html">框架</a></li>
                <li><a href="../../../page/list/database.html">数据库</a></li>
                <li><a href="../../../page/list/arch.html">架构</a></li>
                <li><a href="../../../page/list/jvm.html">虚拟机</a></li>
                <li><a href="../../../page/list/bigdata.html">大数据</a></li>
                <li><a href="../../../page/list/tool.html">工具</a></li>
            </ul>
            <div class="clear"></div>
            <hr>

            <!-- article -->
            <h4>Articles</h4>
            <ul class="blogroll">
                <li><a href="../../../page/article/database/1-1.html">MySql性能优化</a></li>
                <li><a href="../../../page/article/database/1-2.html">Binary Log简介</a></li>
                <li><a href="../../../page/article/arch/1-1.html">分布式服务框架概述</a></li>
                <li><a href="../../../page/article/arch/1-2.html">通信框架设计：技术选型和可靠性</a></li>
                <li><a href="../../../page/article/bigdata/1-1.html">Spark快速入门</a></li>
                <li><a href="../../../page/article/jvm/1-1.html">JVM基础知识概述</a></li>
                <li><a href="../../../page/article/lang/1-2.html">理解Java线程池</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
                <li><a href="#">最近发布</a></li>
            </ul>
            <hr>

        </aside>
    </div>
</div>

<!-- footer -->
<footer>
    <section id="footer_content">
        <div class="container_12">

        </div>
    </section>
    <section id="powered">
        <div class="container_12">
            <p class="grid_10"> code craft by <a href="https://lucifiere.github.io/"
                                                 title="王贤兑的博客" target="_blank"> XD.Wang </a></p>
            <p class="grid_2"><a class="top" href="#">▲ Back to top</a></p>
        </div>
    </section>
</footer>
</body>
</html>